import{j as G,b as H,f as _,r as y,w as T,s as J,G as K,H as E,I as $,J as X,k as d,B as I,u as Y,l as h,x as N,n as L,E as B,F as Q,T as Z,K as ee,L as te,y as oe,D as se,m as ie,p as ae,M as ne,N as re}from"./vue.esm-bundler-C1Jsocv3.js";import{I as le,a as ce}from"./Icon-BXqy_Axv.js";import{v as de}from"./index-CdR1VJ3j.js";import{T as ue}from"./Tooltip-DndxgQTX.js";import{c as w}from"./change-style-properties-1EhjFsjc.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe=["data-testid"],ve=["data-testid"],me=["data-testid"],he=["onClick","data-testid"],O=G({__name:"Popover",props:{isShow:{type:Boolean},iconName:{default:le.moreVertical},options:{default:()=>[]},tooltip:{default:""},tooltipPosition:{default:"top-left"},isWCUse:{type:Boolean},dataTestid:{default:"Popover"}},emits:["close"],setup(V,{emit:q}){const t=V,x=q,i=H({isShow:!1}),F=_(()=>{var o;const e=(o=s.value)==null?void 0:o.closest("dialog");return e||"body"}),u=CSS.supports("top","anchor(bottom)"),D=X(),S=_(()=>`--anchor-popover-${D}`),s=y(null),a=y(null),g=y(null),z=_(()=>({"popover-yui-kit__wrapper":!0,"active-yui-kit":i.isShow,"empty-yui-kit":t.options.length===0})),R=()=>i.isShow=!i.isShow,f=()=>{i.isShow=!1,x("close")},U=e=>{e.function(),f()},c=()=>{requestAnimationFrame(()=>{if(!s.value||!a.value||!i.isShow)return;const e={},o=s.value.getBoundingClientRect(),l=window.pageYOffset||document.documentElement.scrollTop,n=window.pageXOffset||document.documentElement.scrollLeft;let r=o.bottom+l,v=o.left+n;const m=s.value.closest("dialog");if(m){const p=m.getBoundingClientRect();r=o.top-p.top,v=o.left-p.left;const M=m.scrollTop,j=m.scrollLeft;r+=M,v+=j,r+=10}r+=10,e["--popover-top"]=`${r}px`,u||(e["--popover-left"]=`${v}px`),w(e,a.value),(()=>{if(!a.value)return;const p=a.value.getBoundingClientRect();p.right>window.innerWidth&&(u?e["--popover-right"]="anchor(right) ":e["--popover-right"]=`${o.right-p.width}px`)})(),e["--popover-right"]&&(e.left="auto",w(e,a.value))})},k=e=>{const o=e.getBoundingClientRect(),l=document.elementFromPoint(o.left,o.top),n=document.elementFromPoint(o.right,o.bottom);!(l&&e.contains(l))&&!(n&&e.contains(n))&&f()},C=new IntersectionObserver(e=>{e.forEach(o=>{o.isIntersecting||f()})}),W=()=>{s.value&&a.value&&(window.addEventListener("scroll",c,!0),window.addEventListener("resize",c))},b=()=>{s.value&&a.value&&(window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",c))},A=()=>{s.value&&window.addEventListener("scroll",k.bind(null,s.value),!0)},P=()=>{s.value&&window.removeEventListener("scroll",k.bind(null,s.value),!0)};return T(()=>t.isShow,()=>i.isShow=t.isShow),T(()=>i.isShow,()=>{i.isShow?(c(),A()):P(),!u&&(i.isShow?W():b())}),J(()=>{s.value&&w({"anchor-name":`${S.value}`},s.value),a.value&&w({"position-anchor":`${S.value}`},a.value),g.value&&C.observe(g.value),u||c()}),K(()=>{C.disconnect(),P(),u||b()}),(e,o)=>(d(),E(ue,{hint:t.tooltip,size:"small",type:"black",position:t.tooltipPosition,"data-testid":t.dataTestid,"is-can-show":!!t.tooltip&&!i.isShow&&t.options.length>0},{default:$(()=>[I((d(),h("div",{class:"popover-yui-kit",ref_key:"popover",ref:g,"data-testid":`${t.dataTestid}-Popover`},[N("div",{ref_key:"reference",ref:s,class:Q(z.value),"data-testid":`${t.dataTestid}-PopoverShow`,onClick:R},[L(e.$slots,"trigger",{},()=>[B(ce,{class:"popover-yui-kit__icon",name:t.iconName,"data-testid":`${t.dataTestid}-PopoverShow-Icon`},null,8,["name","data-testid"])],!0)],10,ve),(d(),E(Z,{to:F.value,disabled:t.isWCUse},[B(re,{name:"popover-animate"},{default:$(()=>[I(N("div",{class:"popover-yui-kit__content",ref_key:"floating",ref:a},[L(e.$slots,"default",{},()=>{var l;return[(l=t.options)!=null&&l.length?(d(),h("div",{key:0,class:"popover-yui-kit__options","data-testid":`${t.dataTestid}-PopoverShow-Options`},[(d(!0),h(ee,null,te(t.options,(n,r)=>(d(),h("div",{class:"popover-yui-kit__options__item",key:r,style:oe(n.style),onClick:se(v=>U(n),["stop"]),"data-testid":`${t.dataTestid}-Item${r}`},ie(n.value),13,he))),128))],8,me)):ae("",!0)]},!0)],512),[[ne,i.isShow]])]),_:3})],8,["to","disabled"]))],8,fe)),[[Y(de),f,void 0,{bubble:!0}]])]),_:3},8,["hint","position","data-testid","is-can-show"]))}}),be=pe(O,[["__scopeId","data-v-94416a23"]]);O.__docgenInfo={exportName:"default",displayName:"Popover",description:"",tags:{},props:[{name:"dataTestid",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'Popover'"}},{name:"isShow",required:!1,type:{name:"boolean"}},{name:"iconName",required:!1,type:{name:"IconNameEnum"},defaultValue:{func:!1,value:"IconNameEnum.moreVertical"}},{name:"options",required:!1,type:{name:"Array",elements:[{name:"IPopoverOption"}]},defaultValue:{func:!1,value:"() => []"}},{name:"tooltip",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"tooltipPosition",required:!1,type:{name:"TTooltipPosition"},defaultValue:{func:!1,value:"'top-left'"}},{name:"isWCUse",required:!1,type:{name:"boolean"}}],events:[{name:"close"}],slots:[{name:"trigger"},{name:"default"}],sourceFiles:["/home/runner/work/sep_yui/sep_yui/src/components/Popover/Popover.vue"]};export{be as P};
