import{p as H,d as J,k as y,r as _,w as T,o as K,a as X,D as E,G as j,l as d,H as $,I,u as Q,m as h,q as L,s as N,v as B,x as Z,T as ee,F as te,B as oe,E as V,J as se,z as ae,y as ne,K as ie,L as le}from"./vue.esm-bundler-DoruS_V8.js";import{I as re,a as ce}from"./Icon-DSmn-dBw.js";import{v as de}from"./index-CLdhIAn3.js";import{T as ue}from"./Tooltip-wcE3_NN3.js";import{c as w}from"./change-style-properties-1EhjFsjc.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe=["data-testid"],ve=["data-testid"],me=["data-testid"],he=["onClick","data-testid"],q=H({__name:"Popover",props:{isShow:{type:Boolean},iconName:{default:re.moreVertical},options:{default:()=>[]},tooltip:{default:""},tooltipPosition:{default:"top-left"},isWCUse:{type:Boolean},translateY:{default:"0"},dataTestid:{default:"Popover"}},emits:["close"],setup(O,{emit:x}){const t=O,F=x,a=J({isShow:!1}),z=y(()=>{var o;const e=(o=s.value)==null?void 0:o.closest("dialog");return e||"body"}),u=CSS.supports("top","anchor(bottom)"),D=j(),S=y(()=>`--anchor-popover-${D}`),s=_(null),n=_(null),g=_(null),R=y(()=>({"popover-yui-kit__wrapper":!0,"active-yui-kit":a.isShow,"empty-yui-kit":t.options.length===0})),Y=()=>a.isShow=!a.isShow,f=()=>{a.isShow=!1,F("close")},U=e=>{e.function(),f()},c=()=>{requestAnimationFrame(()=>{if(!s.value||!n.value||!a.isShow)return;const e={},o=s.value.getBoundingClientRect(),r=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;let l=o.bottom+r,v=o.left+i;const m=s.value.closest("dialog");if(m){const p=m.getBoundingClientRect();l=o.top-p.top,v=o.left-p.left;const M=m.scrollTop,G=m.scrollLeft;l+=M,v+=G,l+=10}l+=10,e["--popover-top"]=`${l}px`,u||(e["--popover-left"]=`${v}px`),w(e,n.value),(()=>{if(!n.value)return;const p=n.value.getBoundingClientRect();p.right>window.innerWidth&&(u?e["--popover-right"]="anchor(right) ":e["--popover-right"]=`${o.right-p.width}px`)})(),e["--popover-right"]&&(e.left="auto",w(e,n.value))})},k=e=>{const o=e.getBoundingClientRect(),r=document.elementFromPoint(o.left,o.top),i=document.elementFromPoint(o.right,o.bottom);!(r&&e.contains(r))&&!(i&&e.contains(i))&&f()},C=new IntersectionObserver(e=>{e.forEach(o=>{o.isIntersecting||f()})}),W=()=>{s.value&&n.value&&(window.addEventListener("scroll",c,!0),window.addEventListener("resize",c))},b=()=>{s.value&&n.value&&(window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",c))},A=()=>{s.value&&window.addEventListener("scroll",k.bind(null,s.value),!0)},P=()=>{s.value&&window.removeEventListener("scroll",k.bind(null,s.value),!0)};return T(()=>t.isShow,()=>a.isShow=t.isShow),T(()=>a.isShow,()=>{a.isShow?(c(),A()):P(),!u&&(a.isShow?W():b())}),K(()=>{s.value&&w({"anchor-name":`${S.value}`},s.value),n.value&&w({"position-anchor":`${S.value}`},n.value),g.value&&C.observe(g.value),u||c()}),X(()=>{C.disconnect(),P(),u||b()}),(e,o)=>(d(),E(ue,{hint:t.tooltip,size:"small",type:"black",position:t.tooltipPosition,"data-testid":t.dataTestid,"is-can-show":!!t.tooltip&&!a.isShow&&t.options.length>0},{default:$(()=>[I((d(),h("div",{class:"popover-yui-kit",ref_key:"popover",ref:g,"data-testid":`${t.dataTestid}-Popover`},[L("div",{ref_key:"reference",ref:s,class:Z(R.value),"data-testid":`${t.dataTestid}-PopoverShow`,onClick:Y},[N(e.$slots,"trigger",{},()=>[B(ce,{class:"popover-yui-kit__icon",name:t.iconName,"data-testid":`${t.dataTestid}-PopoverShow-Icon`},null,8,["name","data-testid"])],!0)],10,ve),(d(),E(ee,{to:z.value,disabled:t.isWCUse},[B(le,{name:"popover-animate"},{default:$(()=>[I(L("div",{class:"popover-yui-kit__content",style:V({transform:`translateY(${t.translateY})`}),ref_key:"floating",ref:n},[N(e.$slots,"default",{},()=>{var r;return[(r=t.options)!=null&&r.length?(d(),h("div",{key:0,class:"popover-yui-kit__options","data-testid":`${t.dataTestid}-PopoverShow-Options`},[(d(!0),h(te,null,oe(t.options,(i,l)=>(d(),h("div",{class:"popover-yui-kit__options__item",key:l,style:V(i.style),onClick:se(v=>U(i),["stop"]),"data-testid":`${t.dataTestid}-Item${l}`},ae(i.value),13,he))),128))],8,me)):ne("",!0)]},!0)],4),[[ie,a.isShow]])]),_:3})],8,["to","disabled"]))],8,fe)),[[Q(de),f,void 0,{bubble:!0}]])]),_:3},8,["hint","position","data-testid","is-can-show"]))}}),be=pe(q,[["__scopeId","data-v-b942a611"]]);q.__docgenInfo={exportName:"default",displayName:"Popover",description:"",tags:{},props:[{name:"dataTestid",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'Popover'"}},{name:"isShow",required:!1,type:{name:"boolean"}},{name:"iconName",required:!1,type:{name:"IconNameEnum"},defaultValue:{func:!1,value:"IconNameEnum.moreVertical"}},{name:"options",required:!1,type:{name:"Array",elements:[{name:"IPopoverOption"}]},defaultValue:{func:!1,value:"() => []"}},{name:"tooltip",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"tooltipPosition",required:!1,type:{name:"TTooltipPosition"},defaultValue:{func:!1,value:"'top-left'"}},{name:"isWCUse",required:!1,type:{name:"boolean"}},{name:"translateY",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'0'"}}],events:[{name:"close"}],slots:[{name:"trigger"},{name:"default"}],sourceFiles:["/home/runner/work/sep_yui/sep_yui/src/components/Popover/Popover.vue"]};export{be as P};
