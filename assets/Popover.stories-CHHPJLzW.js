import{j as X,b as Y,f as S,r as k,w as E,s as Q,G as Z,H as I,I as $,O as ee,k as p,B as L,u as te,l as w,x as oe,E as N,F as se,J as ne,K as ae,L as ie,y as re,D as le,m as ce,P as pe,p as de,T as ue}from"./vue.esm-bundler-DC1UwcWE.js";import{I as fe,a as ve}from"./Icon-BRmBMtLe.js";import{v as me}from"./index-BqoPcbcE.js";import{T as he}from"./Tooltip-C8NwqHvv.js";import{c as g}from"./change-style-properties-1EhjFsjc.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as O}from"./storybook-BJU81olc.js";const ge=["data-testid"],ye=["data-testid"],_e=["data-testid"],Se=["onClick","data-testid"],D=X({__name:"Popover",props:{isShow:{type:Boolean},iconName:{default:fe.moreVertical},options:{default:()=>[]},tooltip:{default:""},tooltipPosition:{default:"top-left"},isWCUse:{type:Boolean},dataTestid:{default:"Popover"}},emits:["close"],setup(y,{emit:z}){const t=y,R=z,n=Y({isShow:!1}),U=S(()=>{var o;const e=(o=s.value)==null?void 0:o.closest("dialog");return e||"body"}),d=CSS.supports("top","anchor(bottom)"),W=ee(),b=S(()=>`--anchor-popover-${W}`),s=k(null),a=k(null),_=k(null),A=S(()=>({"popover-yui-kit__wrapper":!0,"active-yui-kit":n.isShow,"empty-yui-kit":t.options.length===0})),j=()=>n.isShow=!n.isShow,v=()=>{n.isShow=!1,R("close")},M=e=>{e.function(),v()},c=()=>{requestAnimationFrame(()=>{if(!s.value||!a.value||!n.isShow)return;const e={},o=s.value.getBoundingClientRect(),l=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;let r=o.bottom+l,m=o.left+i;const h=s.value.closest("dialog");if(h){const u=h.getBoundingClientRect();r=o.top-u.top,m=o.left-u.left;const J=h.scrollTop,K=h.scrollLeft;r+=J,m+=K,r+=10}r+=10,e["--popover-top"]=`${r}px`,d||(e["--popover-left"]=`${m}px`),g(e,a.value),(()=>{if(!a.value)return;const u=a.value.getBoundingClientRect();u.right>window.innerWidth&&(d?e["--popover-right"]="anchor(right) ":e["--popover-right"]=`${o.right-u.width}px`)})(),e["--popover-right"]&&(e.left="auto",g(e,a.value))})},P=e=>{const o=e.getBoundingClientRect(),l=document.elementFromPoint(o.left,o.top),i=document.elementFromPoint(o.right,o.bottom);!(l&&e.contains(l))&&!(i&&e.contains(i))&&v()},C=new IntersectionObserver(e=>{e.forEach(o=>{o.isIntersecting||v()})}),G=()=>{s.value&&a.value&&(window.addEventListener("scroll",c,!0),window.addEventListener("resize",c))},T=()=>{s.value&&a.value&&(window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",c))},H=()=>{s.value&&window.addEventListener("scroll",P.bind(null,s.value),!0)},x=()=>{s.value&&window.removeEventListener("scroll",P.bind(null,s.value),!0)};return E(()=>t.isShow,()=>n.isShow=t.isShow),E(()=>n.isShow,()=>{n.isShow?(c(),H()):x(),!d&&(n.isShow?G():T())}),Q(()=>{s.value&&g({"anchor-name":`${b.value}`},s.value),a.value&&g({"position-anchor":`${b.value}`},a.value),_.value&&C.observe(_.value),d||c()}),Z(()=>{C.disconnect(),x(),d||T()}),(e,o)=>(p(),I(he,{hint:t.tooltip,size:"small",type:"black",position:t.tooltipPosition,"data-testid":t.dataTestid,"is-can-show":!!t.tooltip&&!n.isShow&&t.options.length>0},{default:$(()=>[L((p(),w("div",{class:"popover-yui-kit",ref_key:"popover",ref:_,"data-testid":`${t.dataTestid}-Popover`},[oe("div",{ref_key:"reference",ref:s,class:se(A.value),"data-testid":`${t.dataTestid}-PopoverShow`,onClick:j},[N(ve,{class:"popover-yui-kit__icon",name:t.iconName,width:16,height:16,"data-testid":`${t.dataTestid}-PopoverShow-Icon`},null,8,["name","data-testid"])],10,ye),(p(),I(ne,{to:U.value,disabled:t.isWCUse},[N(ue,{name:"popover-animate"},{default:$(()=>{var l;return[(l=t.options)!=null&&l.length?L((p(),w("div",{key:0,class:"popover-yui-kit__options",ref_key:"floating",ref:a,"data-testid":`${t.dataTestid}-PopoverShow-Options`},[(p(!0),w(ae,null,ie(t.options,(i,r)=>(p(),w("div",{class:"popover-yui-kit__options__item",style:re(i.style),key:r,onClick:le(m=>M(i),["stop"]),"data-testid":`${t.dataTestid}-Item${r}`},ce(i.value),13,Se))),128))],8,_e)),[[pe,n.isShow]]):de("",!0)]}),_:1})],8,["to","disabled"]))],8,ge)),[[te(me),v,void 0,{bubble:!0}]])]),_:1},8,["hint","position","data-testid","is-can-show"]))}}),F=we(D,[["__scopeId","data-v-3413c3e8"]]);D.__docgenInfo={exportName:"default",displayName:"Popover",description:"",tags:{},props:[{name:"dataTestid",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'Popover'"}},{name:"isShow",required:!1,type:{name:"boolean"}},{name:"iconName",required:!1,type:{name:"IconNameEnum"},defaultValue:{func:!1,value:"IconNameEnum.moreVertical"}},{name:"options",required:!0,type:{name:"Array",elements:[{name:"IPopoverOption"}]},defaultValue:{func:!1,value:"() => []"}},{name:"tooltip",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"tooltipPosition",required:!1,type:{name:"TTooltipPosition"},defaultValue:{func:!1,value:"'top-left'"}},{name:"isWCUse",required:!1,type:{name:"boolean"}}],events:[{name:"close"}],sourceFiles:["/home/runner/work/sep_yui/sep_yui/src/components/Popover/Popover.vue"]};const ke=[{value:"value1",function:()=>console.log("function1")},{value:"value2 value2 value2",function:()=>console.log("function2")}],Ne={title:"Popover/Popover",component:F,argTypes:{title:{control:{type:O.text}},options:{control:{type:O.object}}},tags:["autodocs"]},be=y=>({components:{Popover:F},setup(){return{args:y}},template:`
    <div style="display: flex; flex-direction: row; gap: 12px;">
      <Popover v-bind="args" />
    </div>
  `}),f=be.bind({});f.args={options:ke};var B,V,q;f.parameters={...f.parameters,docs:{...(B=f.parameters)==null?void 0:B.docs,source:{originalSource:`args => ({
  components: {
    Popover
  },
  setup() {
    return {
      args
    };
  },
  template: \`
    <div style="display: flex; flex-direction: row; gap: 12px;">
      <Popover v-bind="args" />
    </div>
  \`
})`,...(q=(V=f.parameters)==null?void 0:V.docs)==null?void 0:q.source}}};const Oe=["Default"];export{f as Default,Oe as __namedExportsOrder,Ne as default};
