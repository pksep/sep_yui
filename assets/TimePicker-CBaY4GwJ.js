import{p as W,d as j,r as J,w as T,k as V,W as K,l as s,m as i,q as l,v as a,u,z as k,I as Q,y as b,B as c,G as w,x as p,F as f,A as x,C as B}from"./vue.esm-bundler-D8QwmNJd.js";import{B as H,a as _}from"./Button-Bk9jAkTK.js";import{I as z}from"./InputNumber-BZW4cWMl.js";import{D as Z}from"./Dialog-DYxK5lQc.js";import{I as g,a as D}from"./Icon-tNVdE72s.js";import{S as E}from"./sizes-9jYRAigb.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"time-picker-dialog-content"},oe={class:"time-picker-header"},ne={key:0,class:"clock-face"},le={key:1,class:"clock-face"},se={key:0,class:"clock-number__dot"},ie={class:"time-picker-actions"},$=W({__name:"TimePicker",props:{modelValue:{},disabled:{type:Boolean},hideClearButton:{type:Boolean}},emits:["update:modelValue"],setup(P,{emit:F}){const d=P,N=F,e=j({openModal:!1,hours:void 0,minutes:void 0,editingValue:"hour",openClock:!1,localHours:void 0,localMinutes:void 0}),v=J(null);T(()=>d.modelValue,n=>{if(n){const t=new Date(n);e.localHours=t.getHours(),e.localMinutes=t.getMinutes()}else e.localHours=void 0,e.localMinutes=void 0},{immediate:!0}),T(()=>e.openModal,n=>{n&&(e.hours=Number(e.localHours)||0,e.minutes=Number(e.localMinutes)||0)});const L=V(()=>e.localHours!==void 0&&e.localMinutes!==void 0?`${String(e.localHours).padStart(2,"0")}:${String(e.localMinutes).padStart(2,"0")}`:"-- --"),R=V(()=>({transform:`rotate(${(e.hours??0)%12*30}deg)`})),q=V(()=>({transform:`rotate(${(e.minutes??0)*6}deg)`}));function y(n,t=100){const o=n%12/12*360,r=t*Math.sin(o*Math.PI/180),m=-t*Math.cos(o*Math.PI/180);return{left:`calc(50% + ${r}px - 24.5px)`,top:`calc(50% + ${m}px - 23.5px)`}}function A(n){var I;const t=(I=v.value)==null?void 0:I.getBoundingClientRect();if(!t)return 0;const o=n.clientX-(t.left+t.width/2),r=n.clientY-(t.top+t.height/2);return(Math.atan2(r,o)*(180/Math.PI)+90+360)%360}function h(n){const t=A(n);if(e.editingValue==="hour"){const r=Math.hypot(n.clientX-(v.value.getBoundingClientRect().left+128),n.clientY-(v.value.getBoundingClientRect().top+128))<90,m=Math.round(t/30)%12||12;e.hours=(r?m+12:m)%24}else e.minutes=Math.round(t/6)%60}function U(n){h(n)}function Y(n){h(n),document.addEventListener("mousemove",S),document.addEventListener("mouseup",M)}function S(n){h(n)}function M(){document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",M)}K(()=>M());function C(){e.openModal=!1}function X(){e.editingValue="hour",e.openModal=!0}function G(){if(e.hours===void 0||e.minutes===void 0)return;const n=d.modelValue?new Date(d.modelValue):new Date,t=new Date(n.getFullYear(),n.getMonth(),n.getDate(),+e.hours,+e.minutes,0,0),o=new Date(t.getTime()).toISOString();N("update:modelValue",o),e.localHours=e.hours,e.localMinutes=e.minutes,C()}function O(){e.hours=void 0,e.minutes=void 0,e.localHours=void 0,e.localMinutes=void 0,N("update:modelValue",null)}return(n,t)=>(s(),i(f,null,[l("div",{class:c({"time-picker-select":!0,disabled:d.disabled})},[l("div",{class:"time-picker-select-content",onClick:X},[a(D,{name:u(g).time},null,8,["name"]),l("span",null,k(L.value),1),!d.hideClearButton&&(e.localHours!==void 0||e.localMinutes!==void 0)?(s(),i("div",{key:0,class:"time-picker-select-clear",onClick:Q(O,["stop"])},[a(D,{name:u(g).closeTag,width:16,height:16},null,8,["name"])])):b("",!0)])],2),a(Z,{open:e.openModal,onClose:C,class:"time-picker-dialog",width:"328px"},{default:w(()=>[l("div",te,[t[11]||(t[11]=l("h3",null,"Установка времени",-1)),l("div",oe,[l("div",null,[a(z,{"model-value":e.hours,"onUpdate:modelValue":t[0]||(t[0]=o=>e.hours=+o),min:0,max:23,class:c({"time-picker-input":!0,pressed:e.editingValue==="hour"}),"input-message":"","is-integer":"","zero-pad":"",onClick:t[1]||(t[1]=o=>e.editingValue="hour")},null,8,["model-value","class"]),t[5]||(t[5]=l("span",null,"Часы",-1))]),t[7]||(t[7]=l("span",{class:"time-picker-separator"},":",-1)),l("div",null,[a(z,{"model-value":e.minutes,"onUpdate:modelValue":t[2]||(t[2]=o=>e.minutes=+o),min:0,max:59,class:c({"time-picker-input":!0,pressed:e.editingValue==="minute"}),"input-message":"","is-integer":"","zero-pad":"",onClick:t[3]||(t[3]=o=>e.editingValue="minute")},null,8,["model-value","class"]),t[6]||(t[6]=l("span",null,"Минуты",-1))])]),e.openClock?(s(),i("div",{key:0,class:"time-picker-clock",ref_key:"clockRef",ref:v,onMousedown:Y,onClick:U},[e.editingValue==="hour"?(s(),i("div",ne,[l("div",{class:"clock-hand",style:p(R.value)},null,4),(s(),i(f,null,x(12,o=>l("div",{key:"outer-"+o,class:c({"clock-number":!0,active:o===Number(e.hours)}),style:p(y(o,100))},k(o),7)),64)),(s(),i(f,null,x(12,o=>l("div",{key:"inner-"+o,class:c({"clock-number":!0,active:o+12===(Number(e.hours)||24)}),style:p(y(o+12,70))},k(o+12),7)),64))])):(s(),i("div",le,[l("div",{class:"clock-hand",style:p(q.value)},null,4),(s(!0),i(f,null,x(Array.from({length:60},(o,r)=>r),o=>(s(),i("div",{key:o,class:c({"clock-number":!0,active:o===Number(e.minutes||0)}),style:p(y(o/5,100))},[o===Number(e.minutes)&&o%5?(s(),i("div",se)):b("",!0),B(" "+k(o%5?"":o%60),1)],6))),128))])),t[8]||(t[8]=l("div",{class:"clock-hand-center"},null,-1))],544)):b("",!0),l("div",ie,[l("div",{class:"time-picker-actions__switch",onClick:t[4]||(t[4]=o=>e.openClock=!e.openClock)},[a(D,{name:e.openClock?u(g).keyboard:u(g).time},null,8,["name"])]),a(H,{size:u(E).little,type:u(_).ghost,onClick:C},{default:w(()=>[...t[9]||(t[9]=[B("Отменить ",-1)])]),_:1},8,["size","type"]),a(H,{size:u(E).little,type:u(_).primary,onClick:G},{default:w(()=>[...t[10]||(t[10]=[B("Сохранить ",-1)])]),_:1},8,["size","type"])])])]),_:1},8,["open"])],64))}}),ve=ee($,[["__scopeId","data-v-c367148c"]]);$.__docgenInfo={exportName:"default",displayName:"TimePicker",description:"",tags:{},props:[{name:"modelValue",required:!1,type:{name:"union",elements:[{name:"string"},{name:"null"}]}},{name:"disabled",required:!1,type:{name:"boolean"}},{name:"hideClearButton",required:!1,type:{name:"boolean"}}],events:[{name:"update:modelValue",type:{names:["union"],elements:[{name:"string"},{name:"null"}]}}],sourceFiles:["/home/runner/work/sep_yui/sep_yui/src/components/TimePicker/TimePicker.vue"]};export{ve as T};
